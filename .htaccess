RewriteEngine On

# Block specific user agents
RewriteCond %{HTTP_USER_AGENT} HTTrack [NC,OR]
RewriteCond %{HTTP_USER_AGENT} SiteSucker [NC,OR]
RewriteCond %{HTTP_USER_AGENT} WebCopier [NC,OR]
RewriteCond %{HTTP_USER_AGENT} WebReaper [NC,OR]
RewriteCond %{HTTP_USER_AGENT} WebStripper [NC,OR]
RewriteCond %{HTTP_USER_AGENT} WebZIP [NC,OR]
RewriteCond %{HTTP_USER_AGENT} Offline Explorer [NC,OR]
RewriteCond %{HTTP_USER_AGENT} Teleport [NC,OR]
RewriteCond %{HTTP_USER_AGENT} wget [NC,OR]
RewriteCond %{HTTP_USER_AGENT} curl [NC,OR]
RewriteCond %{HTTP_USER_AGENT} libwww [NC,OR]
RewriteCond %{HTTP_USER_AGENT} phpcrawl [NC,OR]
RewriteCond %{HTTP_USER_AGENT} nutch [NC,OR]
RewriteCond %{HTTP_USER_AGENT} scrapy [NC,OR]
RewriteCond %{HTTP_USER_AGENT} MJ12bot [NC,OR]
RewriteCond %{HTTP_USER_AGENT} AhrefsBot [NC,OR]
RewriteCond %{HTTP_USER_AGENT} SemrushBot [NC,OR]
RewriteCond %{HTTP_USER_AGENT} ia_archiver [NC,OR]
RewriteCond %{HTTP_USER_AGENT} Baiduspider [NC,OR]
RewriteCond %{HTTP_USER_AGENT} Yandex [NC,OR]
RewriteCond %{HTTP_USER_AGENT} Sogou [NC,OR]
RewriteCond %{HTTP_USER_AGENT} Exabot [NC,OR]
RewriteCond %{HTTP_USER_AGENT} ichiro [NC,OR]
RewriteCond %{HTTP_USER_AGENT} sogou spider [NC,OR]
RewriteCond %{HTTP_USER_AGENT} YoudaoBot [NC,OR]
RewriteCond %{HTTP_USER_AGENT} YetiBOT [NC,OR]
RewriteCond %{HTTP_USER_AGENT} rogerbot [NC,OR]
RewriteCond %{HTTP_USER_AGENT} Xenu [NC,OR]
RewriteCond %{HTTP_USER_AGENT} SEOkicks-Robot [NC,OR]
RewriteCond %{HTTP_USER_AGENT} Mediapartners-Google [NC,OR]
RewriteCond %{HTTP_USER_AGENT} Adsbot-Google [NC,OR]
RewriteCond %{HTTP_USER_AGENT} saveweb2zip [NC]  # Added saveweb2zip
RewriteRule .* - [F,L]

# Block empty user agents
RewriteCond %{HTTP_USER_AGENT} ^-?$
RewriteRule .* - [F,L]

# Rate limiting (adjust values as needed)
<IfModule mod_ratelimit.c>
    SetEnvIf User-Agent ".*" RATE_LIMIT
    <Location />
        SetOutputFilter RATE_LIMIT
        SetEnv rate-limit 5
        SetEnv rate-initial-burst 10
    </Location>
</IfModule>

# Prevent hotlinking
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^https?://(www\.)?mohammedomer\.vip [NC]
RewriteRule \.(jpg|jpeg|png|gif|bmp|webp|css|js)$ - [NC,F,L]

# Password protect sensitive directories (example for a directory)
<Directory "/private">
    AuthType Basic
    AuthName "Restricted Area"
    AuthUserFile /path/to/.htpasswd
    Require valid-user
</Directory>

# Content Security Policy (CSP)
<IfModule mod_headers.c>
    Header set Content-Security-Policy "default-src 'self'; script-src 'self'; style-src 'self'; img-src 'self';"
</IfModule>

# Disable right-click and inspect element (note: this doesn't provide full protection)
<IfModule mod_headers.c>
    Header set Content-Security-Policy "script-src 'self';"
</IfModule>

# Block access to certain files
<FilesMatch "\.(htaccess|htpasswd|config|ini|log|sh)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Prevent directory listing
Options -Indexes
